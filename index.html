<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Despesas - Viagem Cumuruxatiba</title>
    
    <!-- React e ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para JSX -->
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    
    <!-- Recharts -->
    <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const Dashboard = () => {
          const expenses = [
            { date: '17/02/2024', category: 'Alimentação', description: 'Lanche na estrada', value: 73.50 },
            { date: '17/02/2024', category: 'Alimentação', description: 'Água', value: 4.00 },
            { date: '18/02/2024', category: 'Alimentação', description: 'Restaurante', value: 13.00 },
            { date: '17/02/2024', category: 'Hotelaria', description: 'Hotel em Ipatinga', value: 354.00 },
            { date: '17/02/2024', category: 'Outros', description: 'Gorjeta', value: 2.00 },
            { date: '17/02/2024', category: 'Combustível', description: 'Combustível', value: 162.33 },
            { date: '18/02/2024', category: 'Combustível', description: 'Combustível', value: 178.01 },
            { date: '18/02/2024', category: 'Combustível', description: 'Combustível', value: 150.54 }
          ];

          const COLORS = {
            'Alimentação': '#FFD93D',
            'Hotelaria': '#95D5B2',
            'Outros': '#8DB3E2',
            'Combustível': '#FF9B9B'
          };

          const categoryTotals = expenses.reduce((acc, curr) => {
            acc[curr.category] = (acc[curr.category] || 0) + curr.value;
            return acc;
          }, {});

          const pieData = Object.entries(categoryTotals).map(([name, value]) => ({
            name,
            value,
            percentage: ((value / expenses.reduce((acc, curr) => acc + curr.value, 0)) * 100).toFixed(1)
          }));

          const fuelExpenses = expenses.filter(e => e.category === 'Combustível');
          const nonFuelExpenses = expenses.filter(e => e.category !== 'Combustível');
          const fuelTotal = fuelExpenses.reduce((acc, curr) => acc + curr.value, 0);
          const nonFuelTotal = nonFuelExpenses.reduce((acc, curr) => acc + curr.value, 0);
          const grandTotal = fuelTotal + nonFuelTotal;

          return (
            <div className="min-h-screen bg-gray-50 p-4 md:p-8">
              <div className="max-w-7xl mx-auto">
                <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
                  <h1 className="text-2xl md:text-3xl font-bold text-gray-900 mb-2">Dashboard de Despesas</h1>
                  <p className="text-gray-600">Viagem para Cumuruxatiba - Carolina Resende</p>
                </div>
                
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                  <div className="bg-white p-6 rounded-xl shadow-lg">
                    <h2 className="text-xl font-semibold mb-6 text-gray-800">Gastos por Categoria</h2>
                    <div className="h-80">
                      <Recharts.ResponsiveContainer width="100%" height="100%">
                        <Recharts.BarChart data={pieData} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>
                          <Recharts.CartesianGrid strokeDasharray="3 3" />
                          <Recharts.XAxis dataKey="name" />
                          <Recharts.YAxis />
                          <Recharts.Tooltip 
                            formatter={(value) => `R$ ${value.toFixed(2)}`}
                            contentStyle={{ backgroundColor: '#fff', borderRadius: '8px', border: 'none', boxShadow: '0 2px 8px rgba(0,0,0,0.15)' }}
                          />
                          <Recharts.Bar dataKey="value" radius={[4, 4, 0, 0]}>
                            {pieData.map((entry, index) => (
                              <Recharts.Cell key={`cell-${index}`} fill={COLORS[entry.name]} />
                            ))}
                          </Recharts.Bar>
                        </Recharts.BarChart>
                      </Recharts.ResponsiveContainer>
                    </div>
                  </div>

                  <div className="bg-white p-6 rounded-xl shadow-lg">
                    <h2 className="text-xl font-semibold mb-6 text-gray-800">Distribuição de Gastos</h2>
                    <div className="flex">
                      <div className="w-1/2">
                        <Recharts.ResponsiveContainer width="100%" height={300}>
                          <Recharts.PieChart>
                            <Recharts.Pie
                              data={pieData}
                              cx="50%"
                              cy="50%"
                              innerRadius={60}
                              outerRadius={120}
                              fill="#8884d8"
                              paddingAngle={5}
                              dataKey="value"
                            >
                              {pieData.map((entry, index) => (
                                <Recharts.Cell key={`cell-${index}`} fill={COLORS[entry.name]} />
                              ))}
                            </Recharts.Pie>
                            <Recharts.Tooltip 
                              formatter={(value) => `R$ ${value.toFixed(2)}`}
                              contentStyle={{ backgroundColor: '#fff', borderRadius: '8px', border: 'none', boxShadow: '0 2px 8px rgba(0,0,0,0.15)' }}
                            />
                          </Recharts.PieChart>
                        </Recharts.ResponsiveContainer>
                      </div>
                      <div className="w-1/2 flex items-center">
                        <div className="space-y-4">
                          {pieData.map((entry, index) => (
                            <div key={index} className="flex items-center gap-2">
                              <div className="w-4 h-4 rounded" style={{ backgroundColor: COLORS[entry.name] }}></div>
                              <span className="text-sm">
                                {entry.name}:<br/>
                                <span className="font-semibold">R$ {entry.value.toFixed(2)}</span>
                                <span className="text-gray-500 text-xs"> ({entry.percentage}%)</span>
                              </span>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="bg-white p-6 rounded-xl shadow-lg overflow-hidden">
                  <h2 className="text-xl font-semibold mb-6 text-gray-800">Detalhamento de Despesas</h2>
                  <div className="overflow-x-auto">
                    <table className="min-w-full divide-y divide-gray-200">
                      <thead className="bg-gray-50">
                        <tr>
                          <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                          <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categoria</th>
                          <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descrição</th>
                          <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                        </tr>
                      </thead>
                      <tbody className="bg-white divide-y divide-gray-200">
                        {nonFuelExpenses.map((expense, index) => (
                          <tr key={index} className="hover:bg-gray-50">
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{expense.date}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{expense.category}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{expense.description}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right">
                              R$ {expense.value.toFixed(2)}
                            </td>
                          </tr>
                        ))}
                        <tr className="bg-gray-100 font-medium">
                          <td colSpan={3} className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">Subtotal (Exceto Combustível)</td>
                          <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700 text-right">
                            R$ {nonFuelTotal.toFixed(2)}
                          </td>
                        </tr>
                        {fuelExpenses.map((expense, index) => (
                          <tr key={`fuel-${index}`} className="hover:bg-gray-50">
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{expense.date}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{expense.category}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{expense.description}</td>
                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-right">
                              R$ {expense.value.toFixed(2)}
                            </td>
                          </tr>
                        ))}
                        <tr className="bg-gray-100 font-medium">
                          <td colSpan={3} className="px-6 py-4 whitespace-nowrap text-sm text-gray-700">Subtotal Combustível</td>
                          <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-700 text-right">
                            R$ {fuelTotal.toFixed(2)}
                          </td>
                        </tr>
                        <tr className="bg-gray-200 font-bold">
                          <td colSpan={3} className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Total Geral</td>
                          <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right">
                            R$ {grandTotal.toFixed(2)}
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        // Renderização
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Dashboard />);
    </script>
</body>
</html>
